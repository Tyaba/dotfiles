---
name: mcp-memory
description: user-memory MCPサーバーを使用して、ユーザー情報、プロジェクト、関係性を会話を跨いで永続的に記憶する。ユーザーやプロジェクト、好みに関する情報収集時、または会話中に重要な新情報が現れた際に使用する。
---

# MCP メモリ管理

user-memory MCPサーバーを使用して永続的なメモリを自動管理する。

## 基本概念

### エンティティ
主要なノードで、以下を持つ：
- **name**: 一意な識別子
- **entityType**: person, organization, project, event, concept, location
- **observations**: 原子的な事実の配列

### 関係性
能動態での有向接続（例: "works_at", "develops", "manages"）

### 観察
文字列として保存される原子的な事実。1つの観察 = 1つの事実。

## ワークフロー

### 1. メモリ取得（会話開始時）
```
- search_nodes または open_nodes で既存のメモリを取得
- デフォルトユーザー: "吉野哲平"
- 取得した情報を自然に応答に統合（検索していることを明示しない）
```

### 2. 情報監視（会話中）
以下のカテゴリの新情報を監視：

**a) 基本情報**
- 年齢、性別、居住地、職業、学歴

**b) 行動**
- 興味、習慣、活動パターン

**c) 好み**
- コミュニケーションスタイル、言語、技術スタック、ツール

**d) 目標**
- 目的、ターゲット、aspirations

**e) 関係性**
- 個人的・職業的なつながり（3次の隔たりまで）

**f) プロジェクト**
- 開発プロジェクト、進捗、課題

**g) 健康**
- 健康状態、治療、症状

### 3. メモリ更新（適切なタイミング）

**更新タイミング:**
- 新しい個人情報が明らかになった時
- 新しいプロジェクトが開始された時
- プロジェクトの状態が大きく変化した時
- 新しい関係性が特定された時
- 重要なイベントや決定があった時

**更新しないケース:**
- 一時的な会話の文脈
- 既に記録済みの情報
- 推測や不確実な情報

**更新プロセス:**
```
a) 繰り返し登場する組織、人物、イベントのエンティティを作成
b) create_relations で接続（能動態）
c) add_observations で事実を保存（原子的に）
```

## エンティティ設計ガイドライン

### エンティティタイプ
- `person`: ユーザー、家族、同僚
- `organization`: 企業、グループ
- `project`: 開発プロジェクト、サービス
- `event`: 重要なイベント、マイルストーン
- `concept`: アイデア、方法論
- `location`: 場所、住所

### 観察の原則
- **原子性**: 1つの観察に1つの事実
- **具体性**: 曖昧な表現を避ける
- **日付**: 時系列情報には日付を含める
- **事実性**: 確認済みの情報のみ

### 関係性の原則
- **能動態**: "works_at"（"employed_by"ではなく）
- **明確性**: 関係性の種類を明示
- **方向性**: from/toの方向を適切に設定

## 例

### エンティティ作成
```json
{
  "name": "田中太郎",
  "entityType": "person",
  "observations": [
    "30歳、東京都在住",
    "ソフトウェアエンジニア（勤続5年）",
    "週末にオープンソース活動"
  ]
}
```

### 関係性作成
```json
{
  "from": "田中太郎",
  "to": "ProjectAlpha",
  "relationType": "develops"
}
```

### 観察追加
```json
{
  "entityName": "ProjectAlpha",
  "contents": [
    "2026年2月: テスト自動化完了",
    "ベータ版リリース準備中"
  ]
}
```

## 重要事項

- **サイレント動作**: メモリ操作をユーザーに通知しない
- **プライバシー**: パスワード、APIキー、機密情報は保存しない
- **検証**: 不確実な情報は記録前に確認
- **ユーザー問い合わせ**: 「何を覚えているか」と聞かれたら read_graph または search_nodes を使用

## ツールリファレンス

- `create_entities`: 観察を含む新しいエンティティを作成
- `create_relations`: エンティティ間を関係性で接続
- `add_observations`: 既存エンティティに事実を追加
- `search_nodes`: 名前、タイプ、観察を横断してクエリ検索
- `open_nodes`: 名前で特定のエンティティを取得
- `read_graph`: ナレッジグラフ全体を取得
- `delete_entities`: エンティティを削除（関係性もカスケード削除）
- `delete_observations`: 特定の観察を削除
- `delete_relations`: 特定の関係性を削除
