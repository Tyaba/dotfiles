---
name: ddd-scaffold
description: DDD（ドメイン駆動設計）のレイヤー構造の生成と依存関係ルールの管理を行います。新規モジュールの作成や構造の確認時に使用します。
---

# DDD Scaffold Skill

このSkillは、プロジェクトにおけるDDD（ドメイン駆動設計）の整合性を保ち、適切なレイヤー構造を維持・生成するためのものです。

## レイヤー定義と依存関係ルール

以下のルールを厳格に守ってください：

1.  **domain**: 他のどのレイヤーにも依存してはならない（純粋なビジネスロジック、エンティティ、リポジトリのインターフェース）。
2.  **usecase**: `domain` レイヤーにのみ依存してよい。アプリケーションの実行環境に依存しないビジネスフローを記述する。
3.  **app**: `usecase` と `domain` に依存してよい。外部（API, CLI等）からの入力を受け取り、usecaseを呼び出す。
4.  **infra**: `domain` のインターフェースの実装（リポジトリ実装、DB, 外部APIクライアント等）を行う。`domain` にのみ依存してよい。

## 推奨ディレクトリ構造（Pythonの場合）

```text
src/[module_name]/
├── domain/
│   ├── model/
│   ├── repository/
│   └── service/
├── usecase/
├── app/
└── infra/
    ├── repository/
    └── service/
```

## リポジトリインターフェース設計ルール

リポジトリ（`domain/repository/`）のインターフェースは以下を厳守すること：

1. **全メソッドがリスト入出力**: `save(models: list[Model])`, `get_by_id(ids: list[str]) -> list[Model]` のように常にリストで入出力する。単一操作は要素1のリストで呼び出す。
2. **命名は `save` / `get_*` / `delete` で統一**: `list_*` や `save_bulk` は使わない。
3. **存在しないIDは無視**: `get_by_id` で見つからないIDがあってもエラーにせず、見つかったもののみ返す。

## 使用タイミング
- 新しい機能モジュールを追加するとき
- 既存のコードがどのレイヤーに属すべきか迷ったとき
- レイヤー間の依存関係が正しくない可能性があるとき
